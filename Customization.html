<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rev's Tacoshop | Customize Meal</title>

    <link rel="stylesheet" href="Customization.css">

    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<script>
    const supabase = supabase.createClient(
        "https://kowghadptgwjnnhoauaz.supabase.co",
        "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imtvd2doYWRwdGd3am5uaG9hdXoiLCJyb2xlIjoiYW5vbiIsImlhdCI6MTczMjYwMDM2MywiZXhwIjoxNzY0MTM2MzYzfQ.J2_JIUT4Fqv8ZRM2xNjeV9HeLJXCRtVbP-0vVJ3Ukjg"
    );
</script>



</head>
<body>

<header>
    <nav>
        <div id="nav_bar">
            <div id="nav_bar_content">
                <a id="logo" href="index.html"><img src="image.png" alt="Rev's Tacoshop Logo"></a>
                <a href="Menu.html">MENU</a>
                <a href="Customization.html">Customize Your Meal</a>
                <a href="contactus.html">CONTACT US</a>
                <a href="Cart.html">CART </a>
            </div>
        </div>
    </nav>
</header>

<main>
    <section id="order_section">

        <h1><u>Your Subway is Just Few Clicks Away</u></h1>
        <h2><u>Customize Your Meal</u></h2>

        <!-- -------------------------
             CUSTOMIZATION FORM
        -------------------------- -->

        <form id="order_form" action="action.php" method="post">

            <!-- Meal Type -->
            <div class="form_group">
                <h3>Select Your Meal</h3>
                <label><input type="checkbox" class="meal_type" value="Sandwich"> Sandwich</label><br>
                <label><input type="checkbox" class="meal_type" value="Burger"> Burger</label>
            </div>

            <!-- Bread Type -->
            <div class="form_group">
                <h3>Select The Type Of Bread</h3>
                <label><input type="radio" name="bread" value="White Bread"> White Bread</label><br>
                <label><input type="radio" name="bread" value="Whole Wheat Bread"> Whole Wheat Bread</label><br>
                <label><input type="radio" name="bread" value="Sourdough Bread"> Sourdough Bread</label>
            </div>

            <!-- Veggies -->
            <div class="form_group">
                <h3>Select Veggies</h3>
                <label><input type="checkbox" class="veggie" value="Lettuce"> Lettuce</label><br>
                <label><input type="checkbox" class="veggie" value="Tomato"> Tomato</label><br>
                <label><input type="checkbox" class="veggie" value="Cucumber"> Cucumber</label><br>
                <label><input type="checkbox" class="veggie" value="Peppers"> Peppers</label><br>
                <label><input type="checkbox" class="veggie" value="Olives"> Olives</label><br>
                <label><input type="checkbox" class="veggie" value="Avocado"> Avocado</label>
            </div>

            <!-- Note -->
            <div class="form_group">
                <h3>Chef's Note</h3>
                <textarea id="chef_note" placeholder="Enter some description..." rows="8"></textarea>
            </div>

            <!-- Original SheetDB Submission -->
            <div class="form_buttons">
                <!-- <input type="submit" value="Submit Response"> -->
                <input type="reset" value="Reset Form">
            </div>
        </form>

        <hr><br>

        <!-- ADD TO CART BUTTON -->
        <button id="add_to_cart_btn" class="add_to_cart_btn">Add Customized Meal to Cart </button>

        <div id="order_links">
            <button onclick="window.location.href='Cart.html'">Your Cart</button>
            <button onclick="window.location.href='index.html'">Go To Main Page</button>
        </div>

    </section>
</main>

<footer>
    <section id="footer">
        <div id="links">
            <a href="#">OUR FOOD</a>
            <a href="#">FIND US</a>
            <a href="#">NEWS</a>
            <a href="#">WORK WITH US</a>
            <a href="#">WHAT'S NEW</a>
            <a href="#">ABOUT US</a>
            <a href="#">CONTACT US</a>
            <a href="#">TERMS & CONDITIONS</a>
        </div>

        <div id="copyright">
            <div id="pic">
                <a href="#"><img src="image.png" alt="Footer Logo"></a>
                <h6>©2025 Rev's Tacoshop — All Rights Reserved.</h6>
            </div>
        </div>
    </section>
</footer>

<!-- ==========================
     ADD TO CART SCRIPT
=========================== -->
<script>
document.getElementById("add_to_cart_btn").addEventListener("click", function () {

    let mealTypes = Array.from(document.querySelectorAll(".meal_type:checked")).map(i => i.value);
    let bread = document.querySelector("input[name='bread']:checked");
    let veggies = Array.from(document.querySelectorAll(".veggie:checked")).map(i => i.value);
    let note = document.getElementById("chef_note").value;

    // VALIDATION
    if (mealTypes.length === 0) {
        alert("Please select at least one meal type.");
        return;
    }
    if (!bread) {
        alert("Please select a bread type.");
        return;
    }

    // PRICE LOGIC
    let price = 120;              // Base price
    price += veggies.length * 10; // 10₹ per extra veggie

    // CART OBJECT
    let customMeal = {
        name: `Custom ${mealTypes.join(" & ")} (${bread.value})`,
        price: price,
        img: "custom_meal.jpg",
        veggies: veggies,
        note: note
    };

    // SAVE TO CART
    let cart = JSON.parse(localStorage.getItem("cart")) || [];
    cart.push(customMeal);
    localStorage.setItem("cart", JSON.stringify(cart));

    alert("Your customized meal has been added to the cart! ");
});
</script>

</body>
</html>
